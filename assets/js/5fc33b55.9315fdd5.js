"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[1617],{6393:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>o,contentTitle:()=>t,default:()=>d,frontMatter:()=>l,metadata:()=>c,toc:()=>a});var s=r(4848),i=r(8453);const l={},t="Runner\u5b89\u88c5\u4e0e\u521d\u6b65\u4f7f\u7528",c={id:"tools/ci/runner_use",title:"Runner\u5b89\u88c5\u4e0e\u521d\u6b65\u4f7f\u7528",description:"1.\u5982\u4f55\u5b89\u88c5runner",source:"@site/docs/tools/ci/runner_use.md",sourceDirName:"tools/ci",slug:"/tools/ci/runner_use",permalink:"/docs/tools/ci/runner_use",draft:!1,unlisted:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/tools/ci/runner_use.md",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"github action for esp",permalink:"/docs/tools/ci/esp_github_action"},next:{title:"\u5982\u4f55\u7b80\u5355\u7684\u5728\u9879\u76ee\u4e2d\u6dfb\u52a0 CI",permalink:"/docs/tools/ci/\u5982\u4f55\u7b80\u5355\u7684\u5728\u9879\u76ee\u4e2d\u6dfb\u52a0 CI"}},o={},a=[{value:"1.\u5982\u4f55\u5b89\u88c5runner",id:"1\u5982\u4f55\u5b89\u88c5runner",level:2},{value:"2.\u57fa\u672c\u4f7f\u7528",id:"2\u57fa\u672c\u4f7f\u7528",level:2},{value:"1.runner\u914d\u7f6e\u6587\u4ef6\u76ee\u5f55",id:"1runner\u914d\u7f6e\u6587\u4ef6\u76ee\u5f55",level:3},{value:"2.\u9879\u76ee\u6307\u5b9a\u8fd0\u884c\u7684\u5bb9\u5668",id:"2\u9879\u76ee\u6307\u5b9a\u8fd0\u884c\u7684\u5bb9\u5668",level:3},{value:"\u5e38\u89c1\u7684gitlab-runner\u547d\u4ee4",id:"\u5e38\u89c1\u7684gitlab-runner\u547d\u4ee4",level:2}];function u(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",img:"img",li:"li",p:"p",pre:"pre",ul:"ul",...(0,i.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.h1,{id:"runner\u5b89\u88c5\u4e0e\u521d\u6b65\u4f7f\u7528",children:"Runner\u5b89\u88c5\u4e0e\u521d\u6b65\u4f7f\u7528"}),"\n",(0,s.jsx)(n.h2,{id:"1\u5982\u4f55\u5b89\u88c5runner",children:"1.\u5982\u4f55\u5b89\u88c5runner"}),"\n",(0,s.jsxs)(n.p,{children:["\u6253\u5f00\u9879\u76ee\uff0c\u8bbe\u7f6e-CICD\u5c31\u53ef\u4ee5\u627e\u5230Runner\u76f8\u5173\u4ecb\u7ecd\r\n",(0,s.jsx)(n.img,{src:r(5098).A+"",width:"826",height:"904"})]}),"\n",(0,s.jsx)(n.p,{children:"\u63a5\u4e0b\u6765\uff0c\u6309\u7167\u63d0\u793a\uff0c\u6ce8\u518crunner"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"gitlab-runner register  --url https://gitlab.com  --token glrt-Yyz8m6Lwz8iKy9CmoATr\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u6267\u884c\u5982\u4e0b\u547d\u4ee4\u5373\u53ef\u770b\u5230runner"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"gitlab-runner run\n"})}),"\n",(0,s.jsx)(n.p,{children:"runner\u51fa\u610f\u5916\u6267\u884c\u6b65\u9aa4\uff1a"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"gitlab-runner stop\r\ngtilab-runner start\r\ngitlab-runner run\n"})}),"\n",(0,s.jsx)(n.h2,{id:"2\u57fa\u672c\u4f7f\u7528",children:"2.\u57fa\u672c\u4f7f\u7528"}),"\n",(0,s.jsx)(n.h3,{id:"1runner\u914d\u7f6e\u6587\u4ef6\u76ee\u5f55",children:"1.runner\u914d\u7f6e\u6587\u4ef6\u76ee\u5f55"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"sudo vim /etc/gitlab-runner/config.toml\n"})}),"\n",(0,s.jsx)(n.h3,{id:"2\u9879\u76ee\u6307\u5b9a\u8fd0\u884c\u7684\u5bb9\u5668",children:"2.\u9879\u76ee\u6307\u5b9a\u8fd0\u884c\u7684\u5bb9\u5668"}),"\n",(0,s.jsx)(n.p,{children:"\u67e5\u770b\u67e5\u770b\u9879\u76ee\u4e2d.gitlab-ci.yml"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"tags: \u6307\u5b9a\u9879\u76ee\u7528\u5230\u7684runner\u662f\u54ea\u4e00\u4e2a"}),"\n",(0,s.jsx)(n.li,{children:"image: \u6307\u5b9a\u7528\u5230\u7684\u5bb9\u5668\u662f\u54ea\u4e00\u4e2a\r\n\u6ce8\u610f\uff0c\u8bb0\u5f97\u67e5\u770bconfig.toml\u4e2d\u662f\u5426\u5b58\u5728\u4f60\u5236\u5b9a\u7684runner\u548c\u955c\u50cf\r\n\u8fd9\u91cc\u4ee5\u9b54\u767e\u76d2\u548cidf5.1\u4e3a\u4f8b\uff0c\u6211\u7684toml\u914d\u7f6e\u5982\u4e0b:"}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:'concurrent = 1\r\ncheck_interval = 0\r\nshutdown_timeout = 0\r\n\r\n[session_server]\r\n  session_timeout = 1800\r\n\r\n[[runners]]\r\n  name = "mobaihe"\r\n  url = "https://gitlab.com/"\r\n  id = 31742189\r\n  token = "glrt-TiztsxcAnXpQ_iP1sicV"\r\n  token_obtained_at = 2024-01-19T16:07:30Z\r\n  token_expires_at = 0001-01-01T00:00:00Z\r\n  executor = "docker"\r\n  [runners.cache]\r\n    MaxUploadedArchiveSize = 0\r\n  [runners.docker]\r\n    tls_verify = false\r\n    image = "espressif/idf:release-v5.1"\r\n    privileged = false\r\n    disable_entrypoint_overwrite = false\r\n    oom_kill_disable = false\r\n    disable_cache = false\r\n    volumes = ["/cache"]\r\n    shm_size = 0\r\n    network_mtu = 0\n'})}),"\n",(0,s.jsxs)(n.p,{children:["\u53ef\u4ee5\u770b\u5230\u6211\u7684\u8fd9\u4e2arunner\u53ebmobaihe\uff0c\u7528\u7684\u662fdocker\u7684\u6267\u884c\u5668\uff0c\u5e76\u4e14\u6307\u5b9a\u6765espressif/idf",":release-v5",".1\u955c\u50cf"]}),"\n",(0,s.jsx)(n.p,{children:"\u6211\u7684\u9879\u76ee\u4e2d\u7684gitlab-ci.yml\u6587\u4ef6\u5982\u4e0b\uff1a"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yml",children:"stages:\r\n  - build\r\n\r\nbuild_job:\r\n  stage: build\r\n  script:\r\n    - gcc hello.c -o hello\r\n    - ./hello\r\n    - rm hello\r\n    - idf.py --help\r\n  tags:\r\n    - mobaihe\r\n  image: espressif/idf:release-v5.1\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u6b63\u597d\u4e0e\u4e4b\u5bf9\u5e94\u3002"}),"\n",(0,s.jsx)(n.h2,{id:"\u5e38\u89c1\u7684gitlab-runner\u547d\u4ee4",children:"\u5e38\u89c1\u7684gitlab-runner\u547d\u4ee4"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"gitlab-runner restart \n"})})]})}function d(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(u,{...e})}):u(e)}},5098:(e,n,r)=>{r.d(n,{A:()=>s});const s=r.p+"assets/images/install_runner-c4f6fe425c1c4cb15ccc2168025635b7.png"},8453:(e,n,r)=>{r.d(n,{R:()=>t,x:()=>c});var s=r(6540);const i={},l=s.createContext(i);function t(e){const n=s.useContext(l);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:t(e.components),s.createElement(l.Provider,{value:n},e.children)}}}]);